{"ast":null,"code":"import{Platform}from'expo-modules-core';import ExpoLocation from'./ExpoLocation';import{LocationAccuracy}from'./Location.types';import{LocationSubscriber}from'./LocationSubscribers';export function installWebGeolocationPolyfill(){if(false){if(!('window'in global)){global.window=global;}if(!('navigator'in global.window)){global.window.navigator={};}window.navigator.geolocation={getCurrentPosition,watchPosition,clearWatch,stopObserving:()=>{}};}}function convertGeolocationOptions(options){return{accuracy:options.enableHighAccuracy?LocationAccuracy.High:LocationAccuracy.Balanced};}function getCurrentPosition(success,error=()=>{},options={}){_getCurrentPositionAsyncWrapper(success,error,options);}async function _getCurrentPositionAsyncWrapper(success,error,options){try{await ExpoLocation.requestPermissionsAsync();const result=await ExpoLocation.getCurrentPositionAsync(convertGeolocationOptions(options));success(result);}catch(e){error(e);}}function watchPosition(success,error,options){const watchId=LocationSubscriber.registerCallback(success);ExpoLocation.watchPositionImplAsync(watchId,options).catch(err=>{LocationSubscriber.unregisterCallback(watchId);error({watchId,message:err.message,code:err.code});});return watchId;}function clearWatch(watchId){LocationSubscriber.unregisterCallback(watchId);}","map":{"version":3,"names":["Platform","ExpoLocation","LocationAccuracy","LocationSubscriber","installWebGeolocationPolyfill","global","window","navigator","geolocation","getCurrentPosition","watchPosition","clearWatch","stopObserving","convertGeolocationOptions","options","accuracy","enableHighAccuracy","High","Balanced","success","error","_getCurrentPositionAsyncWrapper","requestPermissionsAsync","result","getCurrentPositionAsync","e","watchId","registerCallback","watchPositionImplAsync","catch","err","unregisterCallback","message","code"],"sources":["/Users/jamescunningham/Desktop/safepath-sf/node_modules/expo-location/src/GeolocationPolyfill.ts"],"sourcesContent":["import { Platform } from 'expo-modules-core';\n\nimport ExpoLocation from './ExpoLocation';\nimport { LocationObject, LocationAccuracy, LocationOptions } from './Location.types';\nimport { LocationSubscriber } from './LocationSubscribers';\n\ntype GeolocationSuccessCallback = (data: LocationObject) => void;\ntype GeolocationErrorCallback = (error: any) => void;\n\ntype GeolocationOptions = {\n  enableHighAccuracy?: boolean;\n};\n\ndeclare const global: any;\n\n// @needsAudit\n/**\n * Polyfills `navigator.geolocation` for interop with the core React Native and Web API approach to geolocation.\n */\nexport function installWebGeolocationPolyfill(): void {\n  if (Platform.OS !== 'web') {\n    // Make sure `window.navigator` is defined in the global scope.\n    if (!('window' in global)) {\n      global.window = global;\n    }\n    if (!('navigator' in global.window)) {\n      global.window.navigator = {};\n    }\n\n    // @ts-ignore\n    window.navigator.geolocation = {\n      getCurrentPosition,\n      watchPosition,\n      clearWatch,\n\n      // We don't polyfill stopObserving, this is an internal method that probably should not even exist\n      // in react-native docs\n      stopObserving: () => {},\n    };\n  }\n}\n\nfunction convertGeolocationOptions(options: GeolocationOptions): LocationOptions {\n  return {\n    accuracy: options.enableHighAccuracy ? LocationAccuracy.High : LocationAccuracy.Balanced,\n  };\n}\n\nfunction getCurrentPosition(\n  success: GeolocationSuccessCallback,\n  error: GeolocationErrorCallback = () => {},\n  options: GeolocationOptions = {}\n): void {\n  _getCurrentPositionAsyncWrapper(success, error, options);\n}\n\n// This function exists to let us continue to return undefined from getCurrentPosition, while still\n// using async/await for the internal implementation of it\nasync function _getCurrentPositionAsyncWrapper(\n  success: GeolocationSuccessCallback,\n  error: GeolocationErrorCallback,\n  options: GeolocationOptions\n): Promise<any> {\n  try {\n    await ExpoLocation.requestPermissionsAsync();\n    const result = await ExpoLocation.getCurrentPositionAsync(convertGeolocationOptions(options));\n    success(result);\n  } catch (e) {\n    error(e);\n  }\n}\n\n// Polyfill: navigator.geolocation.watchPosition\nfunction watchPosition(\n  success: GeolocationSuccessCallback,\n  error: GeolocationErrorCallback,\n  options: GeolocationOptions\n) {\n  const watchId = LocationSubscriber.registerCallback(success);\n\n  ExpoLocation.watchPositionImplAsync(watchId, options).catch((err) => {\n    LocationSubscriber.unregisterCallback(watchId);\n    error({ watchId, message: err.message, code: err.code });\n  });\n\n  return watchId;\n}\n\n// Polyfill: navigator.geolocation.clearWatch\nfunction clearWatch(watchId: number) {\n  LocationSubscriber.unregisterCallback(watchId);\n}\n"],"mappings":"AAAA,OAASA,QAAQ,KAAQ,mBAAmB,CAE5C,MAAO,CAAAC,YAAY,KAAM,gBAAgB,CACzC,OAAyBC,gBAAgB,KAAyB,kBAAkB,CACpF,OAASC,kBAAkB,KAAQ,uBAAuB,CAe1D,MAAM,SAAU,CAAAC,6BAA6BA,CAAA,EAC3C,SAA2B,CAEzB,GAAI,EAAE,QAAQ,EAAI,CAAAC,MAAM,CAAC,CAAE,CACzBA,MAAM,CAACC,MAAM,CAAGD,MAAM,C,CAExB,GAAI,EAAE,WAAW,EAAI,CAAAA,MAAM,CAACC,MAAM,CAAC,CAAE,CACnCD,MAAM,CAACC,MAAM,CAACC,SAAS,CAAG,EAAE,C,CAI9BD,MAAM,CAACC,SAAS,CAACC,WAAW,CAAG,CAC7BC,kBAAkB,CAClBC,aAAa,CACbC,UAAU,CAIVC,aAAa,CAAEA,CAAA,GAAK,CAAE,C,CACvB,C,CAEL,CAEA,QAAS,CAAAC,yBAAyBA,CAACC,OAA2B,EAC5D,MAAO,CACLC,QAAQ,CAAED,OAAO,CAACE,kBAAkB,CAAGd,gBAAgB,CAACe,IAAI,CAAGf,gBAAgB,CAACgB,Q,CACjF,CACH,CAEA,QAAS,CAAAT,kBAAkBA,CACzBU,OAAmC,CACnCC,KAAA,CAAkCA,CAAA,GAAK,CAAE,CAAC,CAC1CN,OAAA,CAA8B,EAAE,EAEhCO,+BAA+B,CAACF,OAAO,CAAEC,KAAK,CAAEN,OAAO,CAAC,CAC1D,CAIA,cAAe,CAAAO,+BAA+BA,CAC5CF,OAAmC,CACnCC,KAA+B,CAC/BN,OAA2B,EAE3B,GAAI,CACF,KAAM,CAAAb,YAAY,CAACqB,uBAAuB,EAAE,CAC5C,KAAM,CAAAC,MAAM,CAAG,KAAM,CAAAtB,YAAY,CAACuB,uBAAuB,CAACX,yBAAyB,CAACC,OAAO,CAAC,CAAC,CAC7FK,OAAO,CAACI,MAAM,CAAC,C,CACf,MAAOE,CAAC,CAAE,CACVL,KAAK,CAACK,CAAC,CAAC,C,CAEZ,CAGA,QAAS,CAAAf,aAAaA,CACpBS,OAAmC,CACnCC,KAA+B,CAC/BN,OAA2B,EAE3B,KAAM,CAAAY,OAAO,CAAGvB,kBAAkB,CAACwB,gBAAgB,CAACR,OAAO,CAAC,CAE5DlB,YAAY,CAAC2B,sBAAsB,CAACF,OAAO,CAAEZ,OAAO,CAAC,CAACe,KAAK,CAAEC,GAAG,EAAI,CAClE3B,kBAAkB,CAAC4B,kBAAkB,CAACL,OAAO,CAAC,CAC9CN,KAAK,CAAC,CAAEM,OAAO,CAAEM,OAAO,CAAEF,GAAG,CAACE,OAAO,CAAEC,IAAI,CAAEH,GAAG,CAACG,IAAI,CAAE,CAAC,CAC1D,CAAC,CAAC,CAEF,MAAO,CAAAP,OAAO,CAChB,CAGA,QAAS,CAAAf,UAAUA,CAACe,OAAe,EACjCvB,kBAAkB,CAAC4B,kBAAkB,CAACL,OAAO,CAAC,CAChD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}