{"ast":null,"code":"\"use client\";import{useState,useEffect,useRef}from\"react\";import{Input}from\"@/components/ui/input\";import{MapPin,Star,X}from\"lucide-react\";import{getSavedLocations,searchLocations,deleteLocation}from\"@/services/savedLocations\";import{cn}from\"@/lib/utils\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function LocationInput(_ref){let{value,onChange,placeholder,icon,className}=_ref;const[showDropdown,setShowDropdown]=useState(false);const[savedLocations,setSavedLocations]=useState([]);const[filteredLocations,setFilteredLocations]=useState([]);const dropdownRef=useRef(null);const inputRef=useRef(null);// Load saved locations\nuseEffect(()=>{const locations=getSavedLocations();setSavedLocations(locations);},[]);// Filter locations based on input\nuseEffect(()=>{if(value.trim()){const filtered=searchLocations(value);setFilteredLocations(filtered);}else{// Show all saved locations when input is empty\nsetFilteredLocations(savedLocations.slice(0,5));}},[value,savedLocations]);// Handle click outside to close dropdown\nuseEffect(()=>{const handleClickOutside=event=>{if(dropdownRef.current&&!dropdownRef.current.contains(event.target)&&inputRef.current&&!inputRef.current.contains(event.target)){setShowDropdown(false);}};document.addEventListener(\"mousedown\",handleClickOutside);return()=>document.removeEventListener(\"mousedown\",handleClickOutside);},[]);const handleInputChange=e=>{onChange(e.target.value);setShowDropdown(true);};const handleSelectLocation=location=>{onChange(location.address);setShowDropdown(false);};const handleDeleteLocation=(e,id)=>{e.stopPropagation();deleteLocation(id);const updated=getSavedLocations();setSavedLocations(updated);};const handleFocus=()=>{setShowDropdown(true);};return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[icon,/*#__PURE__*/_jsx(Input,{ref:inputRef,placeholder:placeholder,value:value,onChange:handleInputChange,onFocus:handleFocus,className:cn(\"pl-10 h-11 border-2\",className)})]}),showDropdown&&filteredLocations.length>0&&/*#__PURE__*/_jsx(\"div\",{ref:dropdownRef,className:\"absolute z-50 w-full mt-2 bg-white border-2 border-border rounded-xl shadow-lg max-h-60 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"py-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-3 py-2 text-xs font-semibold text-muted-foreground flex items-center gap-1.5\",children:[/*#__PURE__*/_jsx(Star,{className:\"h-3 w-3\"}),\"Saved Locations\"]}),filteredLocations.map(location=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSelectLocation(location),className:\"w-full px-3 py-2.5 text-left hover:bg-primary/10 transition-colors flex items-start gap-3 group\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"h-4 w-4 text-primary mt-0.5 flex-shrink-0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-sm text-foreground truncate\",children:location.name}),location.name!==location.address&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-muted-foreground truncate\",children:location.address})]}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>handleDeleteLocation(e,location.id),className:\"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-destructive/10 rounded\",title:\"Remove location\",children:/*#__PURE__*/_jsx(X,{className:\"h-3.5 w-3.5 text-destructive\"})})]},location.id))]})})]});}","map":{"version":3,"names":["useState","useEffect","useRef","Input","MapPin","Star","X","getSavedLocations","searchLocations","deleteLocation","cn","jsx","_jsx","jsxs","_jsxs","LocationInput","_ref","value","onChange","placeholder","icon","className","showDropdown","setShowDropdown","savedLocations","setSavedLocations","filteredLocations","setFilteredLocations","dropdownRef","inputRef","locations","trim","filtered","slice","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","handleInputChange","e","handleSelectLocation","location","address","handleDeleteLocation","id","stopPropagation","updated","handleFocus","children","ref","onFocus","length","map","onClick","name","title"],"sources":["/Users/jamescunningham/Desktop/safepath-sf/src/components/location-input.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useRef } from \"react\"\nimport { Input } from \"@/components/ui/input\"\nimport { MapPin, Star, X } from \"lucide-react\"\nimport { getSavedLocations, searchLocations, deleteLocation, type SavedLocation } from \"@/services/savedLocations\"\nimport { cn } from \"@/lib/utils\"\n\ninterface LocationInputProps {\n  value: string\n  onChange: (value: string) => void\n  placeholder: string\n  icon: React.ReactNode\n  className?: string\n}\n\nexport default function LocationInput({ value, onChange, placeholder, icon, className }: LocationInputProps) {\n  const [showDropdown, setShowDropdown] = useState(false)\n  const [savedLocations, setSavedLocations] = useState<SavedLocation[]>([])\n  const [filteredLocations, setFilteredLocations] = useState<SavedLocation[]>([])\n  const dropdownRef = useRef<HTMLDivElement>(null)\n  const inputRef = useRef<HTMLInputElement>(null)\n\n  // Load saved locations\n  useEffect(() => {\n    const locations = getSavedLocations()\n    setSavedLocations(locations)\n  }, [])\n\n  // Filter locations based on input\n  useEffect(() => {\n    if (value.trim()) {\n      const filtered = searchLocations(value)\n      setFilteredLocations(filtered)\n    } else {\n      // Show all saved locations when input is empty\n      setFilteredLocations(savedLocations.slice(0, 5))\n    }\n  }, [value, savedLocations])\n\n  // Handle click outside to close dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        dropdownRef.current &&\n        !dropdownRef.current.contains(event.target as Node) &&\n        inputRef.current &&\n        !inputRef.current.contains(event.target as Node)\n      ) {\n        setShowDropdown(false)\n      }\n    }\n\n    document.addEventListener(\"mousedown\", handleClickOutside)\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside)\n  }, [])\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    onChange(e.target.value)\n    setShowDropdown(true)\n  }\n\n  const handleSelectLocation = (location: SavedLocation) => {\n    onChange(location.address)\n    setShowDropdown(false)\n  }\n\n  const handleDeleteLocation = (e: React.MouseEvent, id: string) => {\n    e.stopPropagation()\n    deleteLocation(id)\n    const updated = getSavedLocations()\n    setSavedLocations(updated)\n  }\n\n  const handleFocus = () => {\n    setShowDropdown(true)\n  }\n\n  return (\n    <div className=\"relative\">\n      <div className=\"relative\">\n        {icon}\n        <Input\n          ref={inputRef}\n          placeholder={placeholder}\n          value={value}\n          onChange={handleInputChange}\n          onFocus={handleFocus}\n          className={cn(\"pl-10 h-11 border-2\", className)}\n        />\n      </div>\n\n      {/* Dropdown */}\n      {showDropdown && filteredLocations.length > 0 && (\n        <div\n          ref={dropdownRef}\n          className=\"absolute z-50 w-full mt-2 bg-white border-2 border-border rounded-xl shadow-lg max-h-60 overflow-y-auto\"\n        >\n          <div className=\"py-2\">\n            <div className=\"px-3 py-2 text-xs font-semibold text-muted-foreground flex items-center gap-1.5\">\n              <Star className=\"h-3 w-3\" />\n              Saved Locations\n            </div>\n            {filteredLocations.map((location) => (\n              <button\n                key={location.id}\n                onClick={() => handleSelectLocation(location)}\n                className=\"w-full px-3 py-2.5 text-left hover:bg-primary/10 transition-colors flex items-start gap-3 group\"\n              >\n                <MapPin className=\"h-4 w-4 text-primary mt-0.5 flex-shrink-0\" />\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"font-medium text-sm text-foreground truncate\">{location.name}</div>\n                  {location.name !== location.address && (\n                    <div className=\"text-xs text-muted-foreground truncate\">{location.address}</div>\n                  )}\n                </div>\n                <button\n                  onClick={(e) => handleDeleteLocation(e, location.id)}\n                  className=\"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-destructive/10 rounded\"\n                  title=\"Remove location\"\n                >\n                  <X className=\"h-3.5 w-3.5 text-destructive\" />\n                </button>\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}